# ν…λΌνΌ(Terraform) ν•µμ‹¬ λ…λ Ήμ–΄ λ° μ‹¤λ¬΄ ν™μ© κ°€μ΄λ“

ν…λΌνΌ(Terraform)μ€ IaC (Infrastructure as Code, μ½”λ“λ΅μ„μ μΈν”„λΌ)λ¥Ό κµ¬ν„ν•κΈ° μ„ν• κ°•λ ¥ν• λ„κµ¬μ…λ‹λ‹¤. ν¨μ¨μ μΈ μΈν”„λΌ κ΄€λ¦¬λ¥Ό μ„ν•΄μ„λ” CLI (Command Line Interface, λ…λ Ήμ¤„ μΈν„°νμ΄μ¤) λ…λ Ήμ–΄μ μ •ν™•ν• μ΄ν•΄μ™€ ν™μ©μ΄ ν•„μμ μ…λ‹λ‹¤.

## κΈ°λ³Έ λ…λ Ήμ–΄ μ”μ•½ν‘

| λ…λ Ήμ–΄ | μμ  | μ„¤λ… |
| --- | --- | --- |
| `terraform init` | `terraform init` | ν…λΌνΌ μ‘μ—… λ””λ ‰ν„°λ¦¬λ¥Ό μ΄κΈ°ν™”ν•κ³  ν•„μ”ν• ν”λ¬κ·ΈμΈμ„ λ‹¤μ΄λ΅λ“ν•©λ‹λ‹¤. |
| `terraform plan` | `terraform plan -out=plan.tfplan` | μ‘μ„±ν• μ½”λ“κ°€ μ‹¤μ  μΈν”„λΌμ— μ–΄λ–»κ² μ μ©λ μ§€ μ‹¤ν–‰ κ³„νμ„ λ―Έλ¦¬ λ³΄μ—¬μ¤λ‹λ‹¤. |
| `terraform apply` | `terraform apply "plan.tfplan"` | κ³„νλ λ³€κ²½ μ‚¬ν•­μ„ μ‹¤μ  μΈν”„λΌμ¤νΈλ­μ²μ— μ μ©ν•μ—¬ λ¦¬μ†μ¤λ¥Ό μƒμ„±, μμ •, μ‚­μ ν•©λ‹λ‹¤. |
| `terraform destroy` | `terraform destroy -auto-approve` | ν…λΌνΌμΌλ΅ κ΄€λ¦¬λκ³  μλ” λ¨λ“  μΈν”„λΌ λ¦¬μ†μ¤λ¥Ό μ™„μ „ν μ‚­μ ν•©λ‹λ‹¤. |

## μ‹¬ν™” λ…λ Ήμ–΄ μ”μ•½ν‘

| λ…λ Ήμ–΄ | μμ  | μ„¤λ… |
| --- | --- | --- |
| `terraform state` | `terraform state list` | ν…λΌνΌ μƒνƒ νμΌ(State File)[^1]μ— κΈ°λ΅λ λ¦¬μ†μ¤ λ©λ΅μ„ ν™•μΈν•κ±°λ‚ κ΄€λ¦¬ν•©λ‹λ‹¤. |
| `terraform import` | `terraform import aws_instance.web i-12345` | μλ™μΌλ΅ μƒμ„±λ κΈ°μ΅΄ λ¦¬μ†μ¤λ¥Ό ν…λΌνΌ μƒνƒ νμΌλ΅ κ°€μ Έμµλ‹λ‹¤. |
| `terraform workspace` | `terraform workspace new dev` | λ™μΌν• κµ¬μ„±μ—μ„ λ…λ¦½μ μΈ μ—¬λ¬ μƒνƒ(ν™κ²½)λ¥Ό κ΄€λ¦¬ν•  μ μλ” μ‘μ—… κ³µκ°„μ„ μƒμ„±/λ³€κ²½ν•©λ‹λ‹¤. |
| `terraform validate` | `terraform validate` | μ½”λ“μ λ¬Έλ²•μ  μ¤λ¥λ‚ λ‚΄λ¶€μ μΈ μΌκ΄€μ„± λ¬Έμ κ°€ μ—†λ”μ§€ κ²€μ¦ν•©λ‹λ‹¤. |
| `terraform fmt` | `terraform fmt -recursive` | ν…λΌνΌ μ½”λ“λ¥Ό ν‘μ¤€ μ¤νƒ€μΌ κ°€μ΄λ“μ— λ§κ² μλ™μΌλ΅ μ •λ ¬ν•κ³  ν¬λ§·ν…ν•©λ‹λ‹¤. |

---

## λ…λ Ήμ–΄ μƒμ„Έ μ„¤λ… λ° μ‹¤λ¬΄ κ°€μ΄λ“

### 1. κΈ°λ³Έ λ…λ Ήμ–΄ (Basic Commands)

* **`terraform init`**: ν…λΌνΌ ν”„λ΅μ νΈλ¥Ό μ‹μ‘ν•  λ• κ°€μ¥ λ¨Όμ € μ‹¤ν–‰ν•΄μ•Ό ν•λ” λ…λ Ήμ–΄μ…λ‹λ‹¤. HCL (HashiCorp Configuration Language, ν•μ‹μ½”ν”„ κµ¬μ„± μ–Έμ–΄) μ½”λ“λ¥Ό λ¶„μ„ν•μ—¬ λ€μƒ ν΄λΌμ°λ“μ Provider (Infrastructure Provider, μΈν”„λΌμ¤νΈλ­μ² μ κ³µμ) ν”λ¬κ·ΈμΈμ„ λ‹¤μ΄λ΅λ“ν•©λ‹λ‹¤. μƒλ΅μ΄ λ¨λ“μ„ μ¶”κ°€ν•κ±°λ‚ λ°±μ—”λ“ μ„¤μ •μ„ λ³€κ²½ν–μ„ λ•λ„ λ‹¤μ‹ μ‹¤ν–‰ν•΄μ•Ό μ •μƒ μ‘λ™ν•©λ‹λ‹¤.
* **`terraform plan`**: μ‹¤μ  μΈν”„λΌλ¥Ό λ³€κ²½ν•κΈ° μ „, μ½”λ“μ λ³€κ²½ μ‚¬ν•­μ΄ μ–΄λ–¤ κ²°κ³Όλ¥Ό κ°€μ Έμ¬μ§€ **μ•μ „ν•κ² μ‹λ®¬λ μ΄μ…**ν•λ” λ…λ Ήμ–΄μ…λ‹λ‹¤. μ¶”κ°€(Add), λ³€κ²½(Change), μ‚­μ (Destroy)λ  λ¦¬μ†μ¤μ κ°μμ™€ μƒμ„Έ λ‚΄μ—­μ„ ν™”λ©΄μ— μ¶λ ¥ν•©λ‹λ‹¤.
* **`terraform apply`**: `plan`μ—μ„ ν™•μΈν• μ‹¤ν–‰ κ³„νμ„ μ‹¤μ  ν΄λΌμ°λ“ ν™κ²½μ— λ°°ν¬ν•κ³  μ μ©ν•©λ‹λ‹¤.
* π¨ **κ³ΌκΈ λ° μ λ£ μ „ν™ μ£Όμ**: AWS (Amazon Web Services, μ•„λ§μ΅΄ μ›Ή μ„λΉ„μ¤) λ“±μ νΌλΈ”λ¦­ ν΄λΌμ°λ“ ν™κ²½μ—μ„ μ΄ λ…λ Ήμ–΄λ¥Ό μ‹¤ν–‰ν•μ—¬ EC2 (Elastic Compute Cloud, νƒ„λ ¥μ  μ»΄ν“¨ν… ν΄λΌμ°λ“) μΈμ¤ν„΄μ¤, RDS (Relational Database Service, κ΄€κ³„ν• λ°μ΄ν„°λ² μ΄μ¤ μ„λΉ„μ¤) λλ” NAT Gateway (Network Address Translation Gateway, λ„¤νΈμ›ν¬ μ£Όμ† λ³€ν™ κ²μ΄νΈμ›¨μ΄)μ™€ κ°™μ€ λ¦¬μ†μ¤λ¥Ό μƒμ„±ν•λ©΄ **μ¦‰κ°μ μΈ μ λ£ κ³ΌκΈμ΄ λ°μƒ**ν•  μ μμµλ‹λ‹¤. μƒμ© μ„λΉ„μ¤ λ°°ν¬ μ‹μ—λ” μ•„ν‚¤ν…μ²μ™€ λΉ„μ© κµ¬μ΅°λ¥Ό λ°λ“μ‹ μ‚¬μ „μ— κ²€ν† ν•΄μ•Ό ν•©λ‹λ‹¤.


* **`terraform destroy`**: ν”„λ΅λΉ„μ €λ‹(Provisioning, IT μΈν”„λΌλ¥Ό μ„¤μ •ν•κ³  λ°°μΉν•λ” ν”„λ΅μ„Έμ¤)λ λ¨λ“  λ¦¬μ†μ¤λ¥Ό μΌκ΄„ μ‚­μ ν•©λ‹λ‹¤. μ‹¤λ¬΄μ—μ„λ” μ£Όλ΅ ν…μ¤νΈ ν™κ²½μ„ μ •λ¦¬ν•  λ• μ‚¬μ©ν•λ©°, μ΄μ(Production) ν™κ²½μ—μ„λ” κ·Ήλ„λ΅ μ£Όμν•΄μ„ μ‚¬μ©ν•΄μ•Ό ν•λ” νκ΄΄μ μΈ λ…λ Ήμ–΄μ…λ‹λ‹¤.

### 2. μ‹¬ν™” λ…λ Ήμ–΄ (Advanced Commands)

* **`terraform state`**: ν…λΌνΌμ€ ν„μ¬ μΈν”„λΌμ μƒνƒλ¥Ό JSON (JavaScript Object Notation, μλ°”μ¤ν¬λ¦½νΈ κ°μ²΄ ν‘κΈ°λ²•) ν•μ‹μ μƒνƒ νμΌμ— μ €μ¥ν•©λ‹λ‹¤. `state mv`(λ¦¬μ†μ¤ μ΄λ¦„ λ³€κ²½), `state rm`(μƒνƒ νμΌμ—μ„λ§ λ¦¬μ†μ¤ μ κ±°) λ“±μ ν•μ„ λ…λ Ήμ–΄λ¥Ό ν†µν•΄ μ‹¤μ  μΈν”„λΌλ¥Ό μ‚­μ ν•μ§€ μ•κ³  ν…λΌνΌμ κ΄€λ¦¬ μƒνƒλ§ μ •κµν•κ² μ΅°μ‘ν•  μ μμµλ‹λ‹¤.
* **`terraform import`**: ν΄λΌμ°λ“ μ›Ή μ½μ†” ν™”λ©΄μ—μ„ μλ™μΌλ΅ λ§λ“  λ¦¬μ†μ¤λ‚, ν…λΌνΌ λ„μ… μ΄μ „μ λ κ±°μ‹(Legacy, κ³Όκ±°μ μ μ‚°) μΈν”„λΌλ¥Ό ν…λΌνΌ κ΄€λ¦¬ μ²΄κ³„ μ•μΌλ΅ νΈμ…μ‹ν‚¬ λ• μ‚¬μ©ν•©λ‹λ‹¤. λ…λ Ήμ–΄ μ‹¤ν–‰ ν›„ ν…λΌνΌ μ½”λ“λ” μ§μ ‘ λ³„λ„λ΅ μ‘μ„±ν•μ—¬ μƒνƒ νμΌκ³Ό μΌμΉμ‹μΌμ•Ό ν•©λ‹λ‹¤.
* **`terraform workspace`**: ν•λ‚μ λ””λ ‰ν„°λ¦¬μ—μ„ `dev`(κ°λ°), `staging`(μ¤ν…μ΄μ§•), `prod`(μ΄μ) λ“± μ—¬λ¬ ν™κ²½μ„ λ…Όλ¦¬μ μΌλ΅ λ¶„λ¦¬ν•μ—¬ κ΄€λ¦¬ν•  λ• μ‚¬μ©ν•©λ‹λ‹¤. μ‘μ—… κ³µκ°„λ³„λ΅ λ…λ¦½μ μΈ μƒνƒ νμΌμ„ μ μ§€ν•  μ μμ–΄ μ½”λ“μ μ¬μ‚¬μ©μ„±κ³Ό λ¨λ“ν™”λ¥Ό λ•μµλ‹λ‹¤.

---

## μ‹¤μ „ ν λ° μμ£Ό μ‹¤μν•λ” λ¶€λ¶„

* π’΅ **μ‹¤μ „ ν: Plan νμΌμ λ¶„λ¦¬ μ €μ¥ λ° μ μ©**
μ‹¤μ  μ΄μ ν™κ²½μ—μ„λ” λ‹¨μν `terraform plan`μ„ λμΌλ΅λ§ ν™•μΈν•κ³  `terraform apply`λ¥Ό λ°”λ΅ μ‹¤ν–‰ν•λ” κ²ƒμ€ μ„ν—ν•©λ‹λ‹¤. κ·Έμ‚¬μ΄μ— λ‹¤λ¥Έ μ‘μ—…μμ— μν•΄ μΈν”„λΌ μƒνƒκ°€ λ³€κ²½λ  μ μκΈ° λ•λ¬Έμ…λ‹λ‹¤.
λ°λ“μ‹ `terraform plan -out=tfplan` λ…λ Ήμ–΄λ΅ μ‹¤ν–‰ κ³„νμ„ νμΌλ΅ κ³ μ •ν•μ—¬ μ €μ¥ν• λ’¤, `terraform apply tfplan` λ…λ Ήμ–΄λ΅ **μ‚¬μ „μ— κ²€μ¦λ κ³„νλ§ μ •ν™•ν•κ² μ μ©**ν•λ” νμ΄ν”„λΌμΈ(Pipeline, μ‘μ—… μ²λ¦¬ μ—°μ‡„ κ³Όμ •)μ„ κµ¬μ¶•ν•΄μ•Ό ν•©λ‹λ‹¤.
* β οΈ **μμ£Ό ν•λ” μ‹¤μ 1: μƒνƒ νμΌ(tfstate) μ§μ ‘ μμ •**
`terraform.tfstate` νμΌμ€ μ‚¬λμ΄ μ½μ„ μ μλ” ν…μ¤νΈ ν•νƒμ§€λ§, μ΄λ¥Ό ν…μ¤νΈ μ—λ””ν„°λ΅ μ§μ ‘ μ—΄μ–΄μ„ μμ •ν•΄μ„λ” μ λ€ μ• λ©λ‹λ‹¤. νμΌ κµ¬μ΅°κ°€ κΉ¨μ§€κ±°λ‚ ν…λΌνΌμ λ™κΈ°ν™”κ°€ μ–΄κΈ‹λ‚ μ „μ²΄ μΈν”„λΌ κ΄€λ¦¬μ— μΉλ…μ μΈ μ¤λ¥λ¥Ό λ°μƒμ‹ν‚µλ‹λ‹¤. λ°μ΄ν„° μμ •μ΄ ν•„μ”ν•  λ•λ” λ°λ“μ‹ `terraform state` CLI λ…λ Ήμ–΄λ¥Ό ν†µν•΄μ„λ§ μ•μ „ν•κ² μ΅°μ‘ν•΄μ•Ό ν•©λ‹λ‹¤.
* β οΈ **μμ£Ό ν•λ” μ‹¤μ 2: λ¦¬μ†μ¤ μ¬μƒμ„± κ°•μ  μ‹ λ…λ Ήμ–΄ μ¤μ© (Taint vs Replace)**
κ³Όκ±°μ—λ” νΉμ • λ¦¬μ†μ¤μ— λ¬Έμ κ°€ μƒκ²¨ κ°•μ λ΅ μ‚­μ  ν›„ λ‹¤μ‹ ν”„λ΅λΉ„μ €λ‹ν•κ³  μ‹¶μ„ λ• `terraform taint` λ…λ Ήμ–΄λ¥Ό μ£Όλ΅ μ‚¬μ©ν–μµλ‹λ‹¤. ν•μ§€λ§ μµμ‹  λ²„μ „μ—μ„λ” μ΄ λ°©μ‹μ΄ κ¶μ¥λμ§€ μ•μµλ‹λ‹¤(Deprecated, μ‚¬μ© μ¤‘λ‹¨). λ€μ‹  `terraform apply -replace="λ¦¬μ†μ¤μ΄λ¦„"` λ…λ Ήμ–΄λ¥Ό μ‚¬μ©ν•λ” κ²ƒμ΄ μ‘μ—…μμ μλ„λ¥Ό ν›¨μ”¬ λ…ν™•ν•κ² ν‘ν„ν•λ©° μ•μ „ν•κ² λ¦¬μ†μ¤λ¥Ό κµμ²΄ν•λ” ν‘μ¤€ λ°©λ²•μ…λ‹λ‹¤.

---

**μ¶μ² λ° μ°Έκ³  μλ£**

* [Terraform CLI Documentation (ν…λΌνΌ κ³µμ‹ CLI λ¬Έμ„)](https://developer.hashicorp.com/terraform/cli)
* [Terraform Registry (ν…λΌνΌ κ³µμ‹ ν”„λ΅λ°”μ΄λ” λ° λ¨λ“ μ €μ¥μ†)](https://registry.terraform.io/)





---

(κ°μΈ λ§μ¶¤ μ„¤μ • ν™•μΈλ€)
μ”μ²­ν•μ‹  κµμ¬ ννΈμ…λ‹λ‹¤. μ§€μ‹ν•μ‹  λ§μ¶¤ μ„¤μ •(μ „λ¬Έ μ©μ–΄ μ „μ²΄ μμ–΄λ… λ° ν•κΈ€ μ„¤λ… λ³‘κΈ°, κΈ΄ μ„¤λ… μ£Όμ„ μ²λ¦¬, μ λ£ κ³ΌκΈ μ„λΉ„μ¤ λ…μ‹, κ°•μ΅° λ° μ‹¤μ „ μμ  ν¬ν•¨, GPT κΈ°λ³Έ μΈμ‚¬λ§ μ μ™Έ λ“±)μ„ λ¨λ‘ μ¤ν…λ°”μ΄μ¤ν…μΌλ΅ ν™•μΈν•κ³  μ¤€μν•μ—¬ μ‘μ„±ν–μµλ‹λ‹¤.

Next Step: ν…λΌνΌ μƒνƒ νμΌ(State File) μ›κ²© μ €μ¥μ† κµ¬μ„± λ° ν‘μ—… μ „λµ

[^1]:
ν…λΌνΌ μƒνƒ νμΌ(State File): ν…λΌνΌμ΄ κ΄€λ¦¬ν•λ” μΈν”„λΌμ ν„μ¬ μƒνƒλ¥Ό μ¶”μ ν•κ³  λ©”νƒ€λ°μ΄ν„°λ¥Ό μ €μ¥ν•λ” νμΌ(`.tfstate`)μ…λ‹λ‹¤. μ‹¤μ  ν΄λΌμ°λ“ ν™κ²½κ³Ό μ‘μ„±λ μ½”λ“ μ‚¬μ΄μ μ°¨μ΄λ¥Ό λΉ„κµν•λ” μ λ€μ μΈ κΈ°μ¤€μ μ΄ λλ©°, ν€ ν‘μ—… μ‹μ—λ” S3μ™€ κ°™μ€ μ›κ²© μ €μ¥μ†(Remote Backend)μ— λ³΄κ΄€ν•μ—¬ μ•μ „ν•κ² κ³µμ ν•κ³  μ κΈ(Locking)μ„ μ„¤μ •ν•λ” κ²ƒμ΄ μ›μΉ™μ…λ‹λ‹¤.
