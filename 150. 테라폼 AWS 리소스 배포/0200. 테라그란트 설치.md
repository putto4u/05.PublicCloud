**Terragrunt(테라그란트)의 이해와 실무 환경 구축 가이드**

[Terragrunt(테라그란트)](https://terragrunt.gruntwork.io/)는 [Gruntwork(그런트워크 - 클라우드 인프라 자동화 및 DevOps 솔루션 기업)](https://gruntwork.io/)에서 개발한 [Terraform(테라폼 - 하시코프에서 개발한 오픈소스 인프라스트럭처 애즈 코드 도구)](https://www.terraform.io/)의 Wrapper(래퍼 - 기본 프로그램의 기능을 감싸서 부가 기능을 제공하는 유틸리티)입니다. 테라폼 코드의 치명적인 단점인 설정 파일(`providers.tf`, `backend.tf` 등)의 반복을 제거하고, 다중 환경(개발, 스테이징, 운영)과 다중 클라우드 계정을 DRY(Don't Repeat Yourself - 코드 중복 최소화 원칙)하게 효율적으로 관리할 수 있게 해줍니다.

---

**1. Terragrunt(테라그란트) 다운로드 및 설치**

테라그란트를 사용하기 위해서는 반드시 시스템에 테라폼이 먼저 설치되어 있어야 합니다. 실무 환경에서는 패키지 관리자를 통한 설치를 권장합니다.

* **macOS 환경 설치 (권장)**
macOS(Big Sur 및 최신 버전 포함) 환경에서는 [Homebrew(홈브루 - macOS용 패키지 관리자)](https://brew.sh/)를 사용하여 간단하게 의존성과 패키지를 설치할 수 있습니다.[^1]
```bash
# 1. 테라폼 설치 (미설치 시)
brew tap hashicorp/tap
brew install hashicorp/tap/terraform

# 2. 테라그란트 설치
brew install terragrunt

```


* **Linux(리눅스) 및 Windows(윈도우) 환경 설치**
[공식 GitHub 릴리스 페이지](https://github.com/gruntwork-io/terragrunt/releases)에서 운영체제에 맞는 바이너리(Binary - 실행 가능한 형식의 파일)를 직접 다운로드하여 시스템 환경 변수(PATH)가 지정된 디렉터리에 넣고 실행 권한을 부여합니다.
* **설치 확인**
터미널에서 아래 명령어를 입력하여 정상적으로 버전이 출력되는지 확인합니다.
```bash
terragrunt --version

```



---

**2. 환경 설정 및 디렉터리 아키텍처 구성**

테라그란트는 `terragrunt.hcl`이라는 고유의 설정 파일을 사용합니다. 중복을 제거하기 위해 최상위 루트 디렉터리에 공통 설정을 두고, 하위 디렉터리에서 이를 상속받는 구조를 설계합니다.

**디렉터리 구조 예시**

```text
live-infrastructure/              # 전체 인프라 최상위 폴더
├── terragrunt.hcl                # 부모(공통) 설정 파일 (Provider 및 Backend 정의)
├── prod/                         # 운영 환경
│   └── web-server/
│       └── terragrunt.hcl        # 자식 설정 파일 (prod 환경에 맞는 변수 주입)
└── dev/                          # 개발 환경
    └── web-server/
        └── terragrunt.hcl        # 자식 설정 파일 (dev 환경에 맞는 변수 주입)

```

**공통 설정 작성 (루트 `terragrunt.hcl`)**
루트 파일에서는 모든 하위 프로젝트가 공통으로 사용할 [Amazon S3(아마존 단순 스토리지 서비스 - 데이터 보관량 및 API 요청 건수에 따라 유료 과금 발생)](https://aws.amazon.com/ko/s3/) 백엔드와 [Amazon DynamoDB(아마존 다이나모디비 - 읽기/쓰기 용량에 따라 유료 과금 발생)](https://aws.amazon.com/ko/dynamodb/) 잠금(Locking) 설정을 한 번만 정의합니다.

```hcl
# 최상위 terragrunt.hcl 파일 예제
remote_state {
  backend = "s3"
  generate = {
    path      = "backend.tf"
    if_exists = "overwrite_terragrunt"
  }
  config = {
    bucket         = "my-terraform-state-bucket"
    key            = "${path_relative_to_include()}/terraform.tfstate"
    region         = "ap-northeast-2"
    encrypt        = true
    dynamodb_table = "my-lock-table"
  }
}

```

위 코드를 통해 하위 디렉터리(`dev`, `prod` 등)에서 명령어를 실행할 때마다 동적으로 고유한 S3 경로(`key`)가 생성되어 상태 파일이 겹치지 않고 안전하게 저장됩니다.

---

**3. 실전 팁 및 주의사항**

> **[자주 오해하거나 실수하는 부분]**
> **오해:** "테라그란트를 도입하면 기존의 테라폼 명령어(`terraform apply`) 대신 완전히 새로운 문법을 배워야 한다."
> **진실:** 테라그란트는 테라폼의 래퍼(Wrapper)이므로 명령어 체계가 거의 동일합니다. `terraform init`, `terraform apply` 대신 터미널에서 `terragrunt init`, `terragrunt apply`를 입력하면 되며, 테라그란트가 설정 파일을 조합한 뒤 내부적으로 테라폼을 호출하여 실행합니다.

> **[실전 팁: 버전 호환성 관리]**
> 테라폼과 테라그란트는 각각 독립적으로 업데이트되므로, 두 도구 간의 버전 호환성을 맞추는 것이 매우 중요합니다. 실무에서는 루트 `terragrunt.hcl` 파일 상단에 `terraform_version_constraint` 및 `terragrunt_version_constraint` 옵션을 명시하여, 팀원 모두가 동일한 버전 환경에서 작업하도록 강제하는 것이 인프라 장애를 예방하는 지름길입니다.

---

---

Next Step: Terragrunt HCL 문법 상세 및 include 블록을 활용한 모듈 상속 실습

[^1]:
macOS 환경에서 홈브루를 통해 패키지를 설치할 때 권한(Permission) 오류가 발생한다면, 무조건 시스템 최고 관리자 권한을 부여하는 `sudo` 명령어를 남발하기보다는 Homebrew 디렉터리의 소유권(Ownership) 설정을 확인하고 수정하는 것이 보안상 안전한 시스템 관리 방법입니다.
