<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Terraform 기반 VPC 아키텍처 자동화 가이드</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700;900&display=swap');
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: #f8fafc; /* Light slate background */
            color: #334155;
            line-height: 1.6;
        }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f5f9; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
        
        .block-animation {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .block-animation:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 24px -8px rgba(15, 23, 42, 0.15);
        }
        
        .expert-tip-bg {
            background: linear-gradient(135deg, #2e1065 0%, #1e1b4b 100%);
            border-left: 4px solid #8b5cf6; /* Violet 500 */
        }

        .diagram-line {
            stroke-dasharray: 6;
            animation: dash 15s linear infinite;
        }
        @keyframes dash {
            to { stroke-dashoffset: -100; }
        }

        /* Terraform syntax highlighting colors */
        .tf-keyword { color: #c678dd; }
        .tf-string { color: #98c379; }
        .tf-type { color: #e5c07b; }
        .tf-comment { color: #5c6370; font-style: italic; }
        .tf-property { color: #d19a66; }
        .tf-variable { color: #61afef; }
    </style>
</head>
<body class="antialiased p-4 md:p-8">

    <div class="max-w-5xl mx-auto bg-white shadow-2xl rounded-2xl overflow-hidden border border-slate-200">
        
        <!-- Header Section -->
        <header class="bg-slate-900 text-white p-8 md:p-12 relative overflow-hidden">
            <div class="absolute top-0 right-0 opacity-10 transform translate-x-1/4 -translate-y-1/4">
                <i class="fas fa-cubes text-9xl text-violet-500"></i>
            </div>
            <div class="relative z-10">
                <span class="bg-violet-900 text-violet-300 border border-violet-700 text-xs font-bold px-3 py-1 rounded-full uppercase tracking-wider mb-4 inline-block shadow-sm">Infrastructure as Code (Expert Practical)</span>
                <h1 class="text-3xl md:text-5xl font-bold mb-4 leading-tight">코드 기반 네트워크 자동화:<br><span class="text-violet-400">Terraform VPC 아키텍처 실무</span></h1>
                <p class="text-lg md:text-xl text-slate-300 max-w-3xl">
                    <a href="https://www.terraform.io/" target="_blank" class="underline hover:text-white font-medium">Terraform(테라폼)</a>을 활용하여 인프라를 코드로 정의(IaC, Infrastructure as Code)합니다. 기초 단일 VPC부터 다중 클러스터 피어링, 대규모 허브 앤 스포크(Hub and Spoke) 네트워크 설계까지, AWS 콘솔 작업의 한계를 넘어서는 재현 가능하고 선언적인 자동화 스크립트 작성 기법을 학습합니다.
                </p>
            </div>
        </header>

        <!-- Main Content -->
        <main class="p-8 md:p-12 space-y-16">

            <!-- Section 1: Single VPC -->
            <section>
                <div class="flex items-center mb-6 border-b-2 border-violet-500 pb-2 inline-block">
                    <h2 class="text-2xl md:text-3xl font-bold text-slate-800 flex items-center">
                        <i class="fas fa-server text-violet-600 mr-3"></i>기초 단일 VPC 구축 및 라우팅 자동화
                    </h2>
                </div>
                
                <div class="bg-white p-6 rounded-xl border border-slate-200 shadow-sm block-animation mb-6">
                    <p class="text-slate-700 leading-relaxed mb-6">
                        실무 표준 3-Tier(3계층) 웹 서비스 환경을 코드로 구축합니다. <strong>Public Subnet(퍼블릭 서브넷)</strong>과 <strong>Private Subnet(프라이빗 서브넷)</strong>을 생성하고, NAT Gateway(네트워크 주소 변환 게이트웨이)와 라우팅 테이블(Route Table) 간의 의존성(Dependency)을 테라폼이 어떻게 자동으로 해석하고 배포하는지 확인합니다.
                    </p>

                    <!-- Diagram: Single VPC -->
                    <div class="bg-slate-50 border border-slate-200 rounded-xl p-6 mb-6 overflow-x-auto">
                        <div class="min-w-[600px] text-center">
                            <div class="text-xs font-bold text-slate-500 mb-2 uppercase tracking-widest">AWS 리전 (서울: ap-northeast-2)</div>
                            <div class="border-2 border-violet-400 bg-violet-50/30 rounded-lg p-6 relative">
                                <div class="absolute -top-3 left-4 bg-white px-2 text-violet-700 font-bold text-sm border border-violet-200 rounded shadow-sm">단일 VPC (10.1.0.0/16)</div>
                                
                                <div class="absolute -top-6 right-8 bg-blue-500 text-white p-2 rounded-lg text-xs font-bold shadow-md flex items-center">
                                    <i class="fas fa-globe mr-2"></i>인터넷 게이트웨이 (IGW)
                                </div>

                                <div class="flex gap-6 mt-4">
                                    <div class="flex-1 border border-blue-300 bg-blue-50 p-4 rounded-lg relative">
                                        <div class="text-xs font-bold text-blue-800 mb-2">퍼블릭 서브넷 (10.1.1.0/24)</div>
                                        <div class="bg-white border border-blue-200 rounded p-2 text-xs text-slate-600 shadow-sm mb-2 flex items-center justify-center">
                                            <i class="fas fa-route text-blue-400 mr-1"></i> 라우팅: 0.0.0.0/0 &rarr; IGW
                                        </div>
                                        <div class="bg-orange-100 border border-orange-300 rounded p-2 text-xs font-bold text-orange-800 shadow-sm flex items-center justify-center relative z-10">
                                            <i class="fas fa-network-wired mr-1"></i> NAT 게이트웨이
                                        </div>
                                    </div>

                                    <div class="flex-1 border border-emerald-300 bg-emerald-50 p-4 rounded-lg relative">
                                        <div class="text-xs font-bold text-emerald-800 mb-2">프라이빗 서브넷 (10.1.2.0/24)</div>
                                        <div class="bg-white border border-emerald-200 rounded p-2 text-xs text-slate-600 shadow-sm mb-2 flex items-center justify-center">
                                            <i class="fas fa-route text-emerald-500 mr-1"></i> 라우팅: 0.0.0.0/0 &rarr; NAT GW
                                        </div>
                                        <div class="bg-slate-800 border border-slate-700 rounded p-2 text-xs font-bold text-white shadow-sm flex items-center justify-center">
                                            <i class="fas fa-database mr-1"></i> 데이터베이스 클러스터
                                        </div>
                                    </div>
                                </div>
                                <svg class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-12 h-6 pointer-events-none" style="z-index: 0;">
                                    <line x1="100%" y1="50%" x2="0" y2="50%" stroke="#cbd5e1" stroke-width="2" marker-end="url(#arrowhead)"/>
                                    <defs>
                                        <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                                            <polygon points="0 0, 10 3.5, 0 7" fill="#cbd5e1" />
                                        </marker>
                                    </defs>
                                </svg>
                            </div>
                        </div>
                    </div>

                    <!-- Terraform Code -->
                    <div class="bg-slate-900 rounded-xl overflow-hidden shadow-lg border border-slate-800">
                        <div class="bg-slate-800 px-4 py-3 border-b border-slate-700 flex justify-between items-center">
                            <h4 class="font-bold text-violet-400 text-sm"><i class="fas fa-code mr-2"></i>Terraform 스크립트 (main.tf)</h4>
                            <span class="text-xs font-bold bg-slate-700 text-slate-300 px-2 py-1 rounded">HCL</span>
                        </div>
                        <div class="p-4 font-mono text-sm text-slate-300 overflow-x-auto leading-relaxed">
                            <pre><code><span class="tf-comment"># 1. VPC 생성</span>
<span class="tf-keyword">resource</span> <span class="tf-string">"aws_vpc"</span> <span class="tf-string">"main"</span> {
  <span class="tf-property">cidr_block</span>           = <span class="tf-string">"10.1.0.0/16"</span>
  <span class="tf-property">enable_dns_hostnames</span> = <span class="tf-keyword">true</span>
  <span class="tf-property">tags</span> = { <span class="tf-property">Name</span> = <span class="tf-string">"Production-VPC"</span> }
}

<span class="tf-comment"># 2. 서브넷 생성 (퍼블릭/프라이빗)</span>
<span class="tf-keyword">resource</span> <span class="tf-string">"aws_subnet"</span> <span class="tf-string">"public"</span> {
  <span class="tf-property">vpc_id</span>            = <span class="tf-variable">aws_vpc</span>.<span class="tf-variable">main</span>.<span class="tf-variable">id</span>  <span class="tf-comment"># 암묵적 의존성 자동 해석</span>
  <span class="tf-property">cidr_block</span>        = <span class="tf-string">"10.1.1.0/24"</span>
  <span class="tf-property">availability_zone</span> = <span class="tf-string">"ap-northeast-2a"</span>
}

<span class="tf-keyword">resource</span> <span class="tf-string">"aws_subnet"</span> <span class="tf-string">"private"</span> {
  <span class="tf-property">vpc_id</span>            = <span class="tf-variable">aws_vpc</span>.<span class="tf-variable">main</span>.<span class="tf-variable">id</span>
  <span class="tf-property">cidr_block</span>        = <span class="tf-string">"10.1.2.0/24"</span>
  <span class="tf-property">availability_zone</span> = <span class="tf-string">"ap-northeast-2a"</span>
}

<span class="tf-comment"># 3. 인터넷 게이트웨이 (IGW)</span>
<span class="tf-keyword">resource</span> <span class="tf-string">"aws_internet_gateway"</span> <span class="tf-string">"igw"</span> {
  <span class="tf-property">vpc_id</span> = <span class="tf-variable">aws_vpc</span>.<span class="tf-variable">main</span>.<span class="tf-variable">id</span>
}

<span class="tf-comment"># 4. 퍼블릭 라우팅 테이블 및 연결</span>
<span class="tf-keyword">resource</span> <span class="tf-string">"aws_route_table"</span> <span class="tf-string">"public_rt"</span> {
  <span class="tf-property">vpc_id</span> = <span class="tf-variable">aws_vpc</span>.<span class="tf-variable">main</span>.<span class="tf-variable">id</span>
  <span class="tf-keyword">route</span> {
    <span class="tf-property">cidr_block</span> = <span class="tf-string">"0.0.0.0/0"</span>
    <span class="tf-property">gateway_id</span> = <span class="tf-variable">aws_internet_gateway</span>.<span class="tf-variable">igw</span>.<span class="tf-variable">id</span>
  }
}

<span class="tf-keyword">resource</span> <span class="tf-string">"aws_route_table_association"</span> <span class="tf-string">"public_assoc"</span> {
  <span class="tf-property">subnet_id</span>      = <span class="tf-variable">aws_subnet</span>.<span class="tf-variable">public</span>.<span class="tf-variable">id</span>
  <span class="tf-property">route_table_id</span> = <span class="tf-variable">aws_route_table</span>.<span class="tf-variable">public_rt</span>.<span class="tf-variable">id</span>
}</code></pre>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section 2: VPC Peering -->
            <section>
                <div class="flex items-center mb-6 border-b-2 border-violet-500 pb-2 inline-block">
                    <h2 class="text-2xl md:text-3xl font-bold text-slate-800 flex items-center">
                        <i class="fas fa-link text-violet-600 mr-3"></i>다중 클러스터 연결: VPC 피어링(Peering)
                    </h2>
                </div>

                <div class="bg-white p-6 rounded-xl border border-slate-200 shadow-sm block-animation">
                    <p class="text-slate-700 leading-relaxed mb-6">
                        개발팀(VPC A)과 데이터베이스 클러스터(VPC B)를 인터넷 없이 직접 연결합니다. 테라폼을 사용하면 <strong>연결 요청(Requester)</strong>과 <strong>수락(Accepter)</strong>, 그리고 <strong>양방향 라우팅 추가</strong>를 하나의 코드로 묶어 누락 없이 정확하게 배포할 수 있습니다.
                    </p>

                    <!-- Diagram: VPC Peering -->
                    <div class="bg-slate-50 border border-slate-200 rounded-xl p-6 mb-6 overflow-x-auto flex justify-center items-center gap-4">
                        <div class="border-2 border-indigo-400 bg-indigo-50 rounded-lg p-4 w-48 text-center relative shadow-sm">
                            <div class="text-xs font-bold text-indigo-800 mb-1">EKS 클러스터 VPC</div>
                            <div class="text-xs font-mono text-slate-500 mb-3">10.1.0.0/16</div>
                            <div class="bg-white border border-slate-200 rounded p-2 text-[10px] text-slate-600 shadow-inner">
                                <span class="font-bold text-rose-500">라우팅:</span><br>10.2.0.0/16 &rarr; pcx-123
                            </div>
                        </div>

                        <div class="flex flex-col items-center">
                            <div class="text-[10px] font-bold text-slate-500 mb-1">VPC 피어링 연결</div>
                            <svg width="100" height="20" class="text-violet-500">
                                <line x1="0" y1="10" x2="100" y2="10" stroke="currentColor" stroke-width="3" class="diagram-line"/>
                                <polygon points="0,10 10,5 10,15" fill="currentColor" />
                                <polygon points="100,10 90,5 90,15" fill="currentColor" />
                            </svg>
                            <div class="text-xs font-mono text-violet-600 font-bold mt-1">pcx-123</div>
                        </div>

                        <div class="border-2 border-emerald-400 bg-emerald-50 rounded-lg p-4 w-48 text-center relative shadow-sm">
                            <div class="text-xs font-bold text-emerald-800 mb-1">데이터베이스 VPC</div>
                            <div class="text-xs font-mono text-slate-500 mb-3">10.2.0.0/16</div>
                            <div class="bg-white border border-slate-200 rounded p-2 text-[10px] text-slate-600 shadow-inner">
                                <span class="font-bold text-rose-500">라우팅:</span><br>10.1.0.0/16 &rarr; pcx-123
                            </div>
                        </div>
                    </div>

                    <!-- Expert Tip -->
                    <div class="bg-slate-900 text-white p-5 rounded-lg shadow-inner expert-tip-bg mb-6">
                        <h4 class="font-bold text-violet-400 mb-2 flex items-center"><i class="fas fa-triangle-exclamation mr-2 text-rose-400"></i>전문가 아키텍처 주의사항: 명시적 의존성(depends_on)</h4>
                        <p class="text-sm text-slate-300 leading-relaxed">
                            테라폼은 리소스 간의 의존성을 자동으로 추론하여 생성 순서를 결정합니다. 하지만 피어링 연결이 완료(Active)되기 전에 라우팅 규칙(<code>aws_route</code>)을 먼저 생성하려고 시도하면 AWS API 에러가 발생합니다. 피어링 수락(<code>aws_vpc_peering_connection_accepter</code>) 블록에 <code>auto_accept = true</code>를 설정하고, 라우팅 리소스에 암묵적 의존성이 정확히 걸려 있는지 확인하는 것이 IaC 설계의 핵심입니다.
                        </p>
                    </div>

                    <!-- Terraform Code -->
                    <div class="bg-slate-900 rounded-xl overflow-hidden shadow-lg border border-slate-800">
                        <div class="bg-slate-800 px-4 py-3 border-b border-slate-700 flex justify-between items-center">
                            <h4 class="font-bold text-violet-400 text-sm"><i class="fas fa-code mr-2"></i>Terraform 스크립트 (peering.tf)</h4>
                        </div>
                        <div class="p-4 font-mono text-sm text-slate-300 overflow-x-auto leading-relaxed">
                            <pre><code><span class="tf-comment"># 1. VPC 피어링 요청 및 자동 수락 (동일 계정 가정)</span>
<span class="tf-keyword">resource</span> <span class="tf-string">"aws_vpc_peering_connection"</span> <span class="tf-string">"peer"</span> {
  <span class="tf-property">vpc_id</span>        = <span class="tf-variable">aws_vpc</span>.<span class="tf-variable">vpc_a</span>.<span class="tf-variable">id</span>      <span class="tf-comment"># 요청자 (Requester)</span>
  <span class="tf-property">peer_vpc_id</span>   = <span class="tf-variable">aws_vpc</span>.<span class="tf-variable">vpc_b</span>.<span class="tf-variable">id</span>      <span class="tf-comment"># 수락자 (Accepter)</span>
  <span class="tf-property">auto_accept</span>   = <span class="tf-keyword">true</span>                  <span class="tf-comment"># 동일 계정 내 자동 수락 옵션</span>

  <span class="tf-property">tags</span> = { <span class="tf-property">Name</span> = <span class="tf-string">"VPC-A-to-VPC-B"</span> }
}

<span class="tf-comment"># 2. VPC A의 라우팅 테이블에 VPC B(10.2.0.0/16) 목적지 추가</span>
<span class="tf-keyword">resource</span> <span class="tf-string">"aws_route"</span> <span class="tf-string">"route_a_to_b"</span> {
  <span class="tf-property">route_table_id</span>            = <span class="tf-variable">aws_route_table</span>.<span class="tf-variable">rt_a</span>.<span class="tf-variable">id</span>
  <span class="tf-property">destination_cidr_block</span>    = <span class="tf-variable">aws_vpc</span>.<span class="tf-variable">vpc_b</span>.<span class="tf-property">cidr_block</span>
  <span class="tf-property">vpc_peering_connection_id</span> = <span class="tf-variable">aws_vpc_peering_connection</span>.<span class="tf-variable">peer</span>.<span class="tf-variable">id</span>
}

<span class="tf-comment"># 3. VPC B의 라우팅 테이블에 VPC A(10.1.0.0/16) 목적지 추가</span>
<span class="tf-keyword">resource</span> <span class="tf-string">"aws_route"</span> <span class="tf-string">"route_b_to_a"</span> {
  <span class="tf-property">route_table_id</span>            = <span class="tf-variable">aws_route_table</span>.<span class="tf-variable">rt_b</span>.<span class="tf-variable">id</span>
  <span class="tf-property">destination_cidr_block</span>    = <span class="tf-variable">aws_vpc</span>.<span class="tf-variable">vpc_a</span>.<span class="tf-property">cidr_block</span>
  <span class="tf-property">vpc_peering_connection_id</span> = <span class="tf-variable">aws_vpc_peering_connection</span>.<span class="tf-variable">peer</span>.<span class="tf-variable">id</span>
}</code></pre>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section 3: Transit Gateway (Hub and Spoke) -->
            <section>
                <div class="flex items-center mb-6 border-b-2 border-violet-500 pb-2 inline-block">
                    <h2 class="text-2xl md:text-3xl font-bold text-slate-800 flex items-center">
                        <i class="fas fa-dharmachakra text-violet-600 mr-3"></i>허브 앤 스포크 (Hub and Spoke) 및 전사 라우팅
                    </h2>
                </div>

                <div class="bg-white p-6 rounded-xl border border-slate-200 shadow-sm block-animation">
                    <p class="text-slate-700 leading-relaxed mb-6">
                        VPC 개수가 늘어나면 <strong>AWS Transit Gateway(전송 게이트웨이)</strong>를 중앙 가상 라우터(Hub)로 두고, 수많은 VPC(Spoke)를 연결하는 아키텍처를 구성합니다. 이 거대한 네트워크 토폴로지를 수동으로 클릭하여 설정하면 휴먼 에러가 반드시 발생하므로, 테라폼의 반복문(<code>for_each</code>) 등을 활용하여 모듈화하는 것이 엔터프라이즈 실무 표준입니다.
                    </p>

                    <!-- Diagram: Transit Gateway -->
                    <div class="bg-slate-50 border border-slate-200 rounded-xl p-8 mb-6 relative">
                        <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-indigo-900 border-4 border-violet-400 rounded-full w-32 h-32 flex flex-col items-center justify-center shadow-xl z-20">
                            <i class="fas fa-arrows-to-circle text-3xl text-white mb-1"></i>
                            <span class="text-[10px] font-bold text-violet-200 text-center uppercase tracking-wider">Transit<br>Gateway</span>
                        </div>

                        <div class="grid grid-cols-2 gap-24 relative z-10">
                            <div class="border-2 border-slate-300 bg-white rounded-lg p-4 text-center shadow-sm relative">
                                <div class="text-xs font-bold text-slate-800 mb-1">개발 VPC (10.1.0.0/16)</div>
                                <div class="bg-slate-100 rounded p-1 text-[10px] text-slate-600">라우팅: 10.0.0.0/8 &rarr; tgw-123</div>
                                <svg class="absolute top-1/2 -right-12 transform -translate-y-1/2 w-12 h-2 text-violet-300 pointer-events-none">
                                    <line x1="0" y1="4" x2="100%" y2="4" stroke="currentColor" stroke-width="3" />
                                </svg>
                            </div>

                            <div class="border-2 border-slate-300 bg-white rounded-lg p-4 text-center shadow-sm relative">
                                <div class="text-xs font-bold text-slate-800 mb-1">운영 VPC (10.2.0.0/16)</div>
                                <div class="bg-slate-100 rounded p-1 text-[10px] text-slate-600">라우팅: 10.0.0.0/8 &rarr; tgw-123</div>
                                <svg class="absolute top-1/2 -left-12 transform -translate-y-1/2 w-12 h-2 text-violet-300 pointer-events-none">
                                    <line x1="0" y1="4" x2="100%" y2="4" stroke="currentColor" stroke-width="3" />
                                </svg>
                            </div>

                            <div class="border-2 border-rose-300 bg-rose-50 rounded-lg p-4 text-center shadow-sm relative">
                                <div class="text-xs font-bold text-rose-800 mb-1">보안 검사 VPC (Inspection)</div>
                                <div class="bg-white rounded p-1 text-[10px] text-slate-600">중앙 방화벽 및 로그 수집</div>
                                <svg class="absolute -top-12 left-1/2 transform -translate-x-1/2 w-2 h-12 text-violet-300 pointer-events-none">
                                    <line x1="4" y1="0" x2="4" y2="100%" stroke="currentColor" stroke-width="3" />
                                </svg>
                            </div>

                            <div class="border-2 border-teal-400 bg-teal-50 rounded-lg p-4 text-center shadow-sm relative">
                                <div class="text-xs font-bold text-teal-800 mb-1">온프레미스 (IDC)</div>
                                <div class="bg-white rounded p-1 text-[10px] text-slate-600">VPN / 전용선 (Direct Connect)</div>
                                <svg class="absolute -top-12 left-1/2 transform -translate-x-1/2 w-2 h-12 text-violet-300 pointer-events-none">
                                    <line x1="4" y1="0" x2="4" y2="100%" stroke="currentColor" stroke-width="3" />
                                </svg>
                            </div>
                        </div>
                    </div>

                    <!-- Billed Service Warning -->
                    <div class="bg-rose-50 border-l-4 border-rose-500 p-4 rounded text-sm text-rose-800 shadow-sm mb-6 flex items-start">
                        <i class="fas fa-file-invoice-dollar text-2xl mr-3 mt-1 text-rose-600"></i>
                        <div>
                            <strong class="block text-base mb-1">비용 경고: Transit Gateway 시간당 및 트래픽 과금</strong>
                            TGW는 생성 후 <strong>연결된 개별 VPC(Attachment)마다 시간당 요금이 청구</strong>되며, TGW를 통과하는 <strong>데이터 처리량(GB당) 비용</strong>이 합산됩니다. 실습을 마친 후 테라폼 <code>terraform destroy</code> 명령어로 즉시 리소스를 완전히 삭제해야 과금 폭탄을 방지할 수 있습니다.
                        </div>
                    </div>

                    <!-- Terraform Code -->
                    <div class="bg-slate-900 rounded-xl overflow-hidden shadow-lg border border-slate-800">
                        <div class="bg-slate-800 px-4 py-3 border-b border-slate-700 flex justify-between items-center">
                            <h4 class="font-bold text-violet-400 text-sm"><i class="fas fa-code mr-2"></i>Terraform 스크립트 (tgw.tf)</h4>
                        </div>
                        <div class="p-4 font-mono text-sm text-slate-300 overflow-x-auto leading-relaxed">
                            <pre><code><span class="tf-comment"># 1. Transit Gateway 생성</span>
<span class="tf-keyword">resource</span> <span class="tf-string">"aws_ec2_transit_gateway"</span> <span class="tf-string">"main"</span> {
  <span class="tf-property">description</span>                     = <span class="tf-string">"Main TGW for Hub-and-Spoke"</span>
  <span class="tf-property">default_route_table_association</span> = <span class="tf-string">"enable"</span>
  <span class="tf-property">default_route_table_propagation</span> = <span class="tf-string">"enable"</span>
  <span class="tf-property">tags</span> = { <span class="tf-property">Name</span> = <span class="tf-string">"Enterprise-TGW"</span> }
}

<span class="tf-comment"># 2. TGW에 VPC 연결 (Attachment)</span>
<span class="tf-keyword">resource</span> <span class="tf-string">"aws_ec2_transit_gateway_vpc_attachment"</span> <span class="tf-string">"vpc1_attach"</span> {
  <span class="tf-property">subnet_ids</span>         = [<span class="tf-variable">aws_subnet</span>.<span class="tf-variable">private1</span>.<span class="tf-variable">id</span>, <span class="tf-variable">aws_subnet</span>.<span class="tf-variable">private2</span>.<span class="tf-variable">id</span>]
  <span class="tf-property">transit_gateway_id</span> = <span class="tf-variable">aws_ec2_transit_gateway</span>.<span class="tf-variable">main</span>.<span class="tf-variable">id</span>
  <span class="tf-property">vpc_id</span>             = <span class="tf-variable">aws_vpc</span>.<span class="tf-variable">vpc1</span>.<span class="tf-variable">id</span>
}

<span class="tf-comment"># 3. VPC 1의 라우팅 테이블에서 사설망(10.0.0.0/8) 트래픽을 TGW로 포워딩</span>
<span class="tf-keyword">resource</span> <span class="tf-string">"aws_route"</span> <span class="tf-string">"vpc1_to_tgw"</span> {
  <span class="tf-property">route_table_id</span>         = <span class="tf-variable">aws_route_table</span>.<span class="tf-variable">vpc1_rt</span>.<span class="tf-variable">id</span>
  <span class="tf-property">destination_cidr_block</span> = <span class="tf-string">"10.0.0.0/8"</span>
  <span class="tf-property">transit_gateway_id</span>     = <span class="tf-ec2_transit_gateway">aws_ec2_transit_gateway</span>.<span class="tf-variable">main</span>.<span class="tf-variable">id</span>
  
  <span class="tf-comment"># Attachment가 완료된 후 라우팅이 추가되도록 명시적 의존성 부여</span>
  <span class="tf-property">depends_on</span> = [<span class="tf-variable">aws_ec2_transit_gateway_vpc_attachment</span>.<span class="tf-variable">vpc1_attach</span>]
}</code></pre>
                        </div>
                    </div>
                </div>
            </section>

        </main>

        <!-- Footnotes Section -->
        <footer class="bg-slate-50 border-t border-slate-200 p-8 text-sm text-slate-500">
            <h4 class="font-bold text-slate-700 mb-3 border-b border-slate-300 pb-2 inline-block">주석 및 용어 설명</h4>
            <ol class="list-decimal list-inside space-y-3 ml-2">
                <li id="fn1"><strong>HCL (HashiCorp Configuration Language)</strong>: 테라폼을 개발한 하시코프(HashiCorp) 사에서 만든 자체 설정 언어입니다. JSON보다 인간이 읽고 쓰기 쉬운 문법 구조를 가지고 있으며, 클라우드 인프라 자원을 선언적으로 모델링하는 데 사용됩니다.</li>
                <li id="fn2"><strong>명시적 의존성 (depends_on)</strong>: 테라폼은 코드에 참조(Reference)된 리소스들의 관계를 파악해 자동으로 생성 순서를 정합니다(암묵적 의존성). 하지만 코드 상의 참조는 없으나 실제 클라우드 아키텍처 상 먼저 생성되어야만 하는 리소스가 있을 경우, <code>depends_on</code> 메타 인수를 사용하여 테라폼 엔진에 생성 순서를 강제로 명시해야 합니다.</li>
                <li id="fn3"><strong>Terraform State (테라폼 상태 파일)</strong>: <code>.tfstate</code> 확장자를 가지는 파일로, 테라폼이 AWS에 생성한 실제 리소스와 개발자가 작성한 코드 사이의 매핑 정보를 저장하는 핵심 파일입니다. 협업 시 이 파일을 S3 버킷과 DynamoDB(잠금 관리)를 통해 중앙 집중식으로 관리하는 것이 필수적입니다.</li>
            </ol>
        </footer>

        <!-- Next Step Banner -->
        <div class="bg-slate-900 text-violet-400 text-center py-6 px-4 font-bold text-lg md:text-xl relative overflow-hidden group cursor-pointer border-t-4 border-violet-500">
            <div class="absolute inset-0 bg-white opacity-0 group-hover:opacity-10 transition duration-300"></div>
            Next Step: CI/CD 파이프라인 연동 및 테라폼 상태(State) 중앙 관리 전략 <i class="fas fa-arrow-right ml-2 text-white group-hover:translate-x-2 transition transform"></i>
        </div>

    </div>

</body>
</html>
