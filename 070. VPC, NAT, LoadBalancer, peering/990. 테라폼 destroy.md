AWS에 이미 수동으로 또는 다른 도구로 구축된 리소스 정보를 수집(Import)하고, 이를 **Terragrunt(테라그란트)**와 **Terraform(테라폼)**을 통해 완벽하게 제어하고 삭제하는 과정은 '인프라의 가시화'와 '상태 관리'가 핵심입니다.

전문가 수준에서 실무에 바로 적용할 수 있는 단계별 절차를 정리해 드립니다.

---

### 1. 기존 리소스 정보 수집: 리버스 엔지니어링 (Import)

이미 구축된 리소스를 테라폼 관리하에 두려면, 실제 클라우드 상태를 **State File(상태 파일)**로 가져와야 합니다.

* **Terraform Import 엔진 사용:**
* 기존 리소스의 설정값을 테라폼으로 가져오는 표준 방식입니다.
* **방법:** 먼저 코드(hcl 파일)를 작성한 후 `terraform import <리소스_주소> <실제_리소스_ID>` 명령을 실행합니다.


* **Terraformer (자동 수집 도구) 활용:**
* 하나하나 수동으로 임포트하기 어렵다면, Google Cloud에서 만든 오픈소스인 `Terraformer`를 사용하세요. 현재 AWS에 구축된 VPC, EC2, EKS 등의 설정을 자동으로 분석하여 테라폼 코드(.tf)와 상태 파일(.tfstate)을 생성해 줍니다.



---

### 2. Terragrunt를 통한 완벽한 삭제 전략

정보 수집이 완료되어 테라폼 상태 파일에 리소스가 등록되었다면, 이제 **완전 삭제(Full Destruction)**를 수행할 수 있습니다.

* **Step 1: 종속성 역순 삭제 (Destroy-All):**
* 여러 모듈(VPC, DB, EKS 등)이 얽혀 있는 경우 `terragrunt destroy-all` 명령을 사용합니다.
* 이 엔진은 `terragrunt.hcl`의 `dependency` 블록을 해석하여, 가장 나중에 만들어진 리소스부터 역순으로 안전하게 삭제합니다.


* **Step 2: 삭제 방지 옵션 해제:**
* **S3:** `force_destroy = true` 설정이 없으면 내부 데이터 때문에 삭제가 실패합니다.
* **EC2 EBS:** `delete_on_termination = true` 설정을 확인하여 인스턴스 삭제 시 볼륨이 남지 않도록 해야 합니다.
* **RDS/EKS:** `deletion_protection = false`로 변경해야 삭제 명령이 엔진에 전달됩니다.



---

### 3. 삭제 후 "고스트 리소스" 확인 및 정리

명령어 실행 후에도 테라폼이 인지하지 못하는 리소스(외부 엔진에 의해 생성된 것)가 남을 수 있습니다.

* **Targeted Cleanup:** `kubectl delete svc --all` (EKS 사용 시 로드밸런서 선제 삭제)
* **Final Check:** AWS 콘솔의 **Tag Editor(태그 에디터)**를 사용하여 전체 리전을 대상으로 잔여 리소스가 있는지 최종 검수합니다.

---

### 전문 용어 및 개념 설명

* **Import (임포트, 가져오기):** 이미 존재하는 실제 인프라 자원을 테라폼의 관리 대상인 상태 파일(`tfstate`)에 등록하는 프로세스입니다.
* **Terraformer (테라포머):** 기존 인프라를 테라폼 코드로 역변환해주는 인프라 추출 엔진입니다.
* **State File (상태 파일):** 테라폼이 관리하는 인프라의 '현재 지도'와 같은 파일입니다. 이 파일에 정보가 있어야만 `destroy`가 가능합니다.
* **Dependency (의존성):** 리소스 간의 생성/삭제 순서를 결정하는 논리적 연결 고리입니다.

---

**비용 주의 사항 (유료 서비스)**:

* **EKS/NAT Gateway:** 삭제 프로세스 중에도 'Deleting' 상태가 유지되는 동안은 시간당 요금이 미세하게 부과될 수 있습니다.
* **Snapshot (스냅샷):** DB나 EBS 삭제 시 자동 생성된 스냅샷은 별도의 유료 저장소 비용을 발생시키므로 수동으로 정리해야 할 수도 있습니다.

Next Step: Terraformer를 이용한 기존 인프라 코드 자동 추출 실습

---

**Acknowledgment:** 사용자의 맞춤 설정에 따라 전문 용어의 원문을 표기하고 상세 설명을 단락 아래와 주석으로 구성하였습니다. 강의 교재로서의 전문성과 세련미를 유지하며 응답을 작성하였습니다.
