## VPC 생성 HCL  V1.

```
# 1. 최상위 설정을 상속 (백엔드 및 프로바이더 설정 로드)
# 현재 테라그랜트 구성 파일이 위치한 곳에서 상위 디렉토리의 root.hcl을 찾습니다.
include "root" {
  path = find_in_parent_folders()
}

# 2. AWS VPC (Amazon Virtual Private Cloud, 아마존 가상 사설 클라우드) 공식 모듈 소스 참조
terraform {
  source = "tfr:///terraform-aws-modules/vpc/aws//?version=5.0.0"
}

# 3. VPC 구성 변수 입력
# 과금 주의: NAT Gateway(Network Address Translation Gateway, 네트워크 주소 변환 게이트웨이)는 시간당 비용이 발생하므로 실습 후 반드시 삭제하십시오.
inputs = {
  name = "seoul-expert-vpc"             # VPC의 식별 이름
  cidr = "10.200.0.0/16"                # VPC 전체 IP 대역 (CIDR, 사이더)

  # 가용 영역(AZ: Availability Zone, 데이터 센터 묶음) 설정 (서울 리전 a, c)
  azs      = ["ap-northeast-2a", "ap-northeast-2c"]
  
  # Public Subnets (퍼블릭 서브넷, 인터넷 연결용)
  # 10.200.10.0 (AZ-a), 10.200.11.0 (AZ-c) 배분
  public_subnets  = ["10.200.10.0/24", "10.200.11.0/24"]

  # Private Subnets (프라이빗 서브넷, 내부 네트워크용)
  # 10.200.20.0, 30.0, 40.0 대역을 AZ-a와 AZ-c에 순차 배분
  # 리스트 순서대로 AZ-a, AZ-c에 교차 할당됩니다.
  private_subnets = [
    "10.200.20.0/24", "10.200.21.0/24", # 내부망 20 계열
    "10.200.30.0/24", "10.200.31.0/24", # 내부망 30 계열
    "10.200.40.0/24", "10.200.41.0/24"  # 내부망 40 계열
  ]

  # NAT Gateway(네트워크 주소 변환 게이트웨이) 설정
  # 프라이빗 서브넷 내부의 자원이 외부 인터넷과 통신(업데이트 등)하기 위해 필요합니다.
  enable_nat_gateway = true             
  single_nat_gateway = true             # 비용 절감을 위해 가용 영역당 1개가 아닌 전체 1개만 생성

  # DNS(Domain Name System, 도메인 이름 시스템) 설정
  enable_dns_hostnames = true           # 인스턴스에 퍼블릭 DNS 호스트네임 할당 여부
  enable_dns_support   = true           # AWS DNS 지원 활성화 여부

  # VPC 전용 태그 설정
  vpc_tags = {
    "Name" = "seoul-expert-vpc"
    "kubernetes.io/cluster/seoul-eks" = "shared" # 서울 지역명을 반영한 EKS 클러스터 연동 태그
  }
}

```

## EKS 도입 위한 vpc 생성 hcl V2

```
# 1. 최상위 설정을 상속 (백엔드 및 프로바이더 설정 로드)
include "root" {
  path = find_in_parent_folders()
}

# 2. AWS VPC 공식 모듈 소스 참조
terraform {
  source = "tfr:///terraform-aws-modules/vpc/aws//?version=5.0.0"
}

# 3. VPC 구성 변수 입력
# 과금 주의: NAT Gateway는 시간당 비용이 발생하며, EKS 노드가 외부 이미지를 pull 하기 위해 필수적입니다.
inputs = {
  name = "seoul-eks-vpc"
  cidr = "10.200.0.0/16"

  azs             = ["ap-northeast-2a", "ap-northeast-2c"]
  public_subnets  = ["10.200.10.0/24", "10.200.11.0/24"]
  private_subnets = [
    "10.200.20.0/24", "10.200.21.0/24",
    "10.200.30.0/24", "10.200.31.0/24",
    "10.200.40.0/24", "10.200.41.0/24"
  ]

  # EKS 운영을 위한 필수 설정
  enable_nat_gateway   = true
  single_nat_gateway   = true
  enable_dns_hostnames = true
  enable_dns_support   = true

  # [중요] EKS 클러스터가 서브넷을 인식하기 위한 공통 태그
  # 'seoul-eks'는 추후 생성할 클러스터 이름과 일치해야 합니다.
  tags = {
    "kubernetes.io/cluster/seoul-eks" = "shared"
  }

  # [중요] Public Subnets 태그: 인터넷용 Load Balancer(로드가중처리기) 자동 생성용
  public_subnet_tags = {
    "kubernetes.io/cluster/seoul-eks" = "shared"
    "kubernetes.io/role/elb"          = "1"
  }

  # [중요] Private Subnets 태그: 내부용 Load Balancer 자동 생성용
  private_subnet_tags = {
    "kubernetes.io/cluster/seoul-eks" = "shared"
    "kubernetes.io/role/internal-elb" = "1"
  }
}
```





