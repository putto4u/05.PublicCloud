# 버전업 문법 변경 V5
**AWS EKS (Elastic Kubernetes Service, 엘라스틱 쿠버네티스 서비스) 테라폼 모듈 v21.x 마이그레이션 적용 코드**

최신 EKS (Elastic Kubernetes Service, 엘라스틱 쿠버네티스 서비스) 테라폼 모듈의 구조적 변경 사항을 반영하여 최적화된 `terragrunt.hcl` 구성 파일입니다. 이전 버전(v19/v20)에서 발생하던 이름 규칙 검증 오류 및 변수명 불일치 문제를 해결하였으며, 변경된 핵심 변수들에 대한 상세한 설명을 주석으로 추가했습니다.

```hcl
# 1. 최상위 설정을 상속 (백엔드 및 프로바이더 설정 로드)
include "root" {
  path = find_in_parent_folders()
}

# VPC(Virtual Private Cloud, 가상 사설 클라우드) 모듈로부터 출력값(VPC ID, Subnet IDs)을 가져오기 위한 의존성 정의
dependency "vpc" {
  config_path = "../ap-northeast-2"
}

# 2. AWS EKS 공식 모듈 소스 참조
terraform {
  source = "tfr:///terraform-aws-modules/eks/aws//?version=21.15.0"
}

# 3. EKS 구성 변수 입력
# 과금 주의: EKS 제어 평면(Control Plane, 컨트롤 플레인)은 시간당 약 $0.10의 비용이 발생하며, 워커 노드용 EC2 인스턴스 비용은 별도입니다.
inputs = {
  # [수정됨] v21.x 업데이트: 기존 'cluster_name'에서 'name'으로 변수명이 직관적으로 변경되었습니다.
  name               = "seoul-eks"          
  
  # [수정됨] v21.x 업데이트: 기존 'cluster_version'에서 'kubernetes_version'으로 변수명이 변경되었습니다.
  kubernetes_version = "1.34"               

  # 네트워크 설정 (VPC 모듈의 출력값 참조)
  vpc_id                 = dependency.vpc.outputs.vpc_id
  subnet_ids             = dependency.vpc.outputs.private_subnets
  
  # [수정됨] v21.x 업데이트: 기존 'cluster_endpoint_public_access'에서 'endpoint_public_access'로 변수명이 간소화되었습니다.
  endpoint_public_access = true             

  # EKS 관리형 노드 그룹 (Managed Node Groups) 설정
  eks_managed_node_groups = {
    general = {
      desired_size = 2                      # 초기 노드 개수
      min_size     = 1                      # 최소 노드 개수
      max_size     = 3                      # 최대 노드 개수 (오토스케일링)

      # 과금 주의: t3.medium 인스턴스 사용에 따른 EC2(Elastic Compute Cloud, 탄력적 컴퓨팅 클라우드) 비용이 발생합니다.
      instance_types = ["t3.medium"]        
      capacity_type  = "ON_DEMAND"          # 온디맨드 방식 (안정적 운영)
    }
  }

  # [수정됨] v21.x 업데이트: 기존 'manage_aws_auth_configmap' 변수는 완전히 제거되었습니다. 
  # 최신 보안 표준인 접근 항목(Access Entry, 액세스 엔트리) 방식을 사용하여 클러스터 생성자에게 관리자 권한을 부여하도록 'enable_cluster_creator_admin_permissions'로 대체되었습니다.
  enable_cluster_creator_admin_permissions = true

  # 태그 설정
  tags = {
    Environment = "Training"
    Terraform   = "true"
  }
}

```

---

* [1] **Control Plane (컨트롤 플레인, 제어 평면)**: 쿠버네티스 클러스터의 두뇌 역할을 하는 구성 요소로, 클러스터의 전반적인 상태를 관리하고 스케줄링, API (Application Programming Interface, 응용 프로그램 프로그래밍 인터페이스) 요청 처리 등을 담당합니다. AWS (Amazon Web Services, 아마존 웹 서비스)에서는 이 부분을 관리형으로 제공하여 사용자의 운영 부담을 줄여줍니다.
* [2] **Access Entry (액세스 엔트리, 접근 항목)**: 쿠버네티스 내부의 ConfigMap (컨피그맵, 설정 맵)을 직접 수정하지 않고도, AWS IAM (Identity and Access Management, 신원 및 접근 관리) 사용자와 역할을 EKS (Elastic Kubernetes Service, 엘라스틱 쿠버네티스 서비스) 클러스터의 권한과 직접 매핑할 수 있게 해주는 최신 권한 관리 메커니즘입니다.

---

개인별 맞춤 설정, 과금 서비스 표기, 전문 용어 한글 해석 및 주석 처리, 깃허브 포맷 적용, GPT 기본 응답 양식 제거 등 요청하신 모든 사항을 확인 및 적용 완료했습니다.

Next Step: EKS OIDC 및 IRSA 설정 구성
