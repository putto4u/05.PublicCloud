# 실무 인프라스트럭처 에즈 코드(IaC) 프로젝트 초기 셋업 및 GitHub(깃허브) 보안 연동

클라우드 인프라를 코드로 다루는 프로젝트를 시작할 때, 가장 먼저 수행해야 할 작업은 로컬 PC(작업자 컴퓨터)에 안전한 작업 공간을 격리하고, 형상 관리 도구인 Git(깃)을 초기화하여 원격 저장소인 GitHub(깃허브)와 연동하는 것입니다. 이 과정에서 실수로 클라우드 접속 키(Credential)나 상태 파일(State File)이 업로드되지 않도록 방어벽(`.gitignore`)을 치는 것이 핵심입니다.

---

### 1단계: 로컬 작업 디렉토리 생성 및 Git(깃) 초기화

터미널(Terminal)을 열고 프로젝트를 진행할 최상위 디렉토리를 생성한 뒤, 해당 폴더를 Git 저장소로 선언합니다.

```bash
# 1. 홈 디렉토리 또는 원하는 작업 공간으로 이동
cd ~

# 2. 프로젝트 최상위 폴더 생성 및 이동
mkdir global-microservices-project
cd global-microservices-project

# 3. 빈 Git 저장소 초기화 (이 폴더의 변경 사항 추적 시작)
git init

```

---

### 2단계: 클라우드 보안의 핵심, `.gitignore` 파일 작성

`git init` 직후, 어떠한 코드도 작성하기 전에 반드시 `.gitignore` 파일을 먼저 생성해야 합니다. 이 파일에 정의된 확장자나 폴더는 GitHub로 절대 전송되지 않습니다. Terraform(테라폼) 운영 시 발생하는 민감한 정보(상태 파일, 임시 캐시, 로컬 환경 변수 등)를 원천 차단합니다.

프로젝트 최상위 경로(`global-microservices-project/`)에 `.gitignore` 파일을 생성하고 아래 내용을 입력하여 저장합니다.

```text
# .gitignore 파일 내용

# 1. Terraform 및 Terragrunt 로컬 캐시 디렉토리
.terraform/
.terragrunt-cache/
**/.terraform/*
**/.terragrunt-cache/*

# 2. 인프라 실물 정보가 평문으로 담긴 상태 파일 (절대 업로드 금지)
*.tfstate
*.tfstate.*

# 3. 크래시 로그 및 재정의 파일
crash.log
override.tf
override.tf.json
*_override.tf
*_override.tf.json

# 4. 자격 증명 및 로컬 환경 변수 파일
*.tfvars
*.tfvars.json
.env
secret.tfvars
credentials.csv

# 5. OS 생성 임시 파일 (macOS 및 Windows)
.DS_Store
Thumbs.db

```

---

### 3단계: GitHub(깃허브) 원격 저장소(Remote Repository) 생성 및 연결

로컬에 안전망을 구축했으므로, 이 코드를 백업하고 팀원과 협업할 수 있는 GitHub 원격 저장소를 연결합니다.

1. **GitHub 웹사이트 접속:** 본인의 GitHub 계정으로 로그인합니다.
2. **새 저장소(New Repository) 생성:**
* `Repository name`: `global-microservices-project` (로컬 폴더명과 일치시키는 것을 권장)
* `Public` 또는 `Private` 선택 (실무 보안을 위해 가급적 `Private` 권장)
* **주의:** `Add a README file`이나 `Add .gitignore` 옵션은 **체크하지 않고** 빈 저장소 상태로 `Create repository` 버튼을 클릭합니다.


3. **로컬과 원격 저장소 연결 (터미널 작업):**
GitHub 화면에 나타난 저장소 주소(URL)를 복사한 뒤, 터미널에서 아래 명령어를 순차적으로 실행합니다.

```bash
# 1. 현재까지의 파일(.gitignore 등)을 스테이징 영역에 추가
git add .

# 2. 첫 번째 커밋(Commit, 확정 저장) 수행
git commit -m "chore: 프로젝트 초기화 및 .gitignore 설정"

# 3. 기본 브랜치(Branch, 작업 가지) 이름을 'main'으로 변경
git branch -M main

# 4. GitHub 원격 저장소 주소 등록 (아래 URL은 본인의 GitHub 주소로 변경해야 함)
git remote add origin https://github.com/본인계정/global-microservices-project.git

# 5. 로컬의 main 브랜치 코드를 원격 저장소로 밀어넣기(Push)
git push -u origin main

```

---

### 4단계: AWS CLI(명령줄 인터페이스) 자격 증명 안전 구성

GitHub 연동이 끝났다면, Terraform이 AWS 클라우드 자원을 생성할 수 있도록 터미널에 통행증을 발급해야 합니다. 앞서 언급한 대로 코드에 키를 하드코딩(Hard-coding)하지 않고 로컬 프로필에 안전하게 캐싱(Caching)합니다.

터미널에서 아래 명령어를 실행하고, AWS IAM(Identity and Access Management, 식별 및 액세스 관리) 콘솔에서 발급받은 키를 입력합니다.

```bash
aws configure

```

* `AWS Access Key ID`: 발급받은 액세스 키 입력
* `AWS Secret Access Key`: 발급받은 시크릿 키 입력
* `Default region name`: `ap-northeast-2` (한국 서울 리전)
* `Default output format`: `json`

> **AWS 과금 및 보안 주의:** `aws configure` 자체는 무료지만, 이 통행증을 얻은 Terraform이 이후 EC2(탄력적 컴퓨팅 클라우드)나 NAT Gateway(NAT 게이트웨이) 구축 코드를 실행하는 순간 권한이 즉시 행사되며 AWS 계정에 과금이 발생하기 시작합니다. 해당 키(Access/Secret)가 담긴 `~/.aws/credentials` 파일은 절대 외부로 유출되어서는 안 됩니다.

---

모든 기초 환경 구성과 보안 방어벽 설정이 완료되었습니다. 이제 이 안전한 디렉토리 위에서 첫 번째 인프라 코드를 작성할 준비가 되었습니다.

Next Step: `000-prerequisites` 디렉토리 하위의 Terragrunt 전역 설정 파일(`terragrunt.hcl`) 및 ECR/IAM 모듈 코드 작성
