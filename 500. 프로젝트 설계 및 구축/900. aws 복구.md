ë°ì´í„°ê°€ ìœ ì‹¤ë˜ì–´ ë‹¹í™©ìŠ¤ëŸ¬ìš°ì…¨ê² ë„¤ìš”. í•˜ì§€ë§Œ ëª¨ë“  ì¸í”„ë¼ë¥¼ **í…Œë¼ê·¸ëŸ°íŠ¸(Terragrunt, í…Œë¼í¼ ì½”ë“œë¥¼ ë” íš¨ìœ¨ì ìœ¼ë¡œ ê´€ë¦¬í•˜ê³  DRY ì›ì¹™ì„ ì§€í‚¤ê²Œ í•´ì£¼ëŠ” ë˜í¼ ë„êµ¬)**ë¡œ êµ¬ì¶•í•˜ì…¨ë‹¤ë©´, ë³µêµ¬ëŠ” ë§¤ìš° ì²´ê³„ì ì´ê³  ì‹ ì†í•˜ê²Œ ì§„í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

í…Œë¼ê·¸ëŸ°íŠ¸ ì•„í‚¤í…ì²˜ì˜ ìµœëŒ€ ê°•ì ì€ **ì½”ë“œì™€ ìƒíƒœ(State)ì˜ ë¶„ë¦¬**ì…ë‹ˆë‹¤. AWSì—ì„œ ìì›ì´ ì§€ì›Œì¡Œë”ë¼ë„ ê¹ƒí—ˆë¸Œ(GitHub)ì— í…Œë¼ê·¸ëŸ°íŠ¸ ì„¤ì • íŒŒì¼ë“¤ì´ ë‚¨ì•„ìˆë‹¤ë©´, ì•„í‚¤í…íŠ¸ ì…ì¥ì—ì„œëŠ” í˜„ì¬ ìƒíƒœë¥¼ 'ìƒˆë¡œê³ ì¹¨'í•˜ê³  ì¬ë°°í¬í•˜ëŠ” ê³¼ì •ì„ ë°Ÿìœ¼ë©´ ë©ë‹ˆë‹¤.

---

## 1. í…Œë¼ê·¸ëŸ°íŠ¸(Terragrunt) í™˜ê²½ ë³µêµ¬ ì „ëµ

í…Œë¼ê·¸ëŸ°íŠ¸ëŠ” í…Œë¼í¼ì˜ ìƒíƒœ íŒŒì¼(`.tfstate`)ì„ ì›ê²© ì €ì¥ì†Œ(S3 ë“±)ì— ìë™ìœ¼ë¡œ ê´€ë¦¬í•©ë‹ˆë‹¤. ì‹¤ì œ ìì›ì´ ì§€ì›Œì¡Œìœ¼ë¯€ë¡œ, ë¡œì»¬ì˜ ìºì‹œì™€ ì›ê²©ì˜ ìƒíƒœ ì •ë³´ë¥¼ ì‹¤ì œ AWS ìƒí™©ê³¼ ë™ê¸°í™”í•˜ëŠ” ê²ƒì´ ìµœìš°ì„ ì…ë‹ˆë‹¤.

### Step 1: í”„ë¡œì íŠ¸ í´ë¡  ë° í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

ë¨¼ì € ê¹ƒí—ˆë¸Œì—ì„œ `awskr01` í”„ë¡œì íŠ¸ë¥¼ ìƒˆë¡œ ê°€ì ¸ì˜µë‹ˆë‹¤. í…Œë¼ê·¸ëŸ°íŠ¸ ì‹¤í–‰ì„ ìœ„í•´ AWS ìê²© ì¦ëª…(Credentials)ì´ í™˜ê²½ ë³€ìˆ˜ì— ì˜¬ë°”ë¥´ê²Œ ì„¤ì •ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.

```bash
git clone https://github.com/ì‚¬ìš©ìì´ë¦„/awskr01.git
cd awskr01

```

### Step 2: í…Œë¼ê·¸ëŸ°íŠ¸ ìºì‹œ ë° ì´ˆê¸°í™” íŒŒì¼ ì •ë¦¬

í…Œë¼ê·¸ëŸ°íŠ¸ëŠ” ì‹¤í–‰ ì‹œ ê° ëª¨ë“ˆ ë””ë ‰í† ë¦¬ì— `.terragrunt-cache` í´ë”ë¥¼ ìƒì„±í•©ë‹ˆë‹¤. ì´ì „ì˜ ê¼¬ì¸ ì •ë³´ê°€ ë‚¨ì§€ ì•Šë„ë¡ ì´ í´ë”ë“¤ì„ ë¨¼ì € ì¼ê´„ ì‚­ì œí•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.

```powershell
# ìœˆë„ìš° íŒŒì›Œì…¸ ê¸°ì¤€ í•˜ìœ„ í´ë”ì˜ ëª¨ë“  ìºì‹œ ì‚­ì œ
Get-ChildItem -Path . -Include .terragrunt-cache -Recurse -Force | Remove-Item -Recurse -Force

```

### Step 3: ìƒíƒœ íŒŒì¼ ë™ê¸°í™” (Refresh)

AWSì—ì„œ ìì›ì´ ìˆ˜ë™ìœ¼ë¡œ ì§€ì›Œì¡Œë‹¤ë©´, í…Œë¼ê·¸ëŸ°íŠ¸ê°€ ê´€ë¦¬í•˜ëŠ” ìƒíƒœ íŒŒì¼ì€ ì—¬ì „íˆ "ìì›ì´ ì¡´ì¬í•œë‹¤"ê³  ì°©ê°í•˜ê³  ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ ë°”ë¡œì¡ê¸° ìœ„í•´ ì•„ë˜ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.

```bash
terragrunt refresh

```

*ì´ ëª…ë ¹ì€ ì‹¤ì œ AWS ì¸í”„ë¼ë¥¼ ì¡°íšŒí•˜ì—¬ ìƒíƒœ íŒŒì¼(`.tfstate`)ì„ ìµœì‹ í™”í•©ë‹ˆë‹¤.*

### Step 4: ì¬ë°°í¬ ì‹¤í–‰ (Apply)

ìƒíƒœ ë™ê¸°í™”ê°€ ëë‚˜ë©´, í…Œë¼ê·¸ëŸ°íŠ¸ ê³„íš(Plan)ì„ í†µí•´ ì–´ë–¤ ìì›ì´ ë‹¤ì‹œ ìƒì„±ë ì§€ í™•ì¸í•œ í›„ ë°°í¬ë¥¼ ì§„í–‰í•©ë‹ˆë‹¤.

```bash
terragrunt run-all plan
terragrunt run-all apply

```

* `run-all`: ì˜ì¡´ì„±ì´ ìˆëŠ” ëª¨ë“  ëª¨ë“ˆ(VPC, EC2, RDS ë“±)ì„ ìˆœì„œëŒ€ë¡œ í•œêº¼ë²ˆì— ì²˜ë¦¬í•©ë‹ˆë‹¤.

---

## 2. í…Œë¼ê·¸ëŸ°íŠ¸ ë³µêµ¬ ì‹œ ì£¼ì˜ì‚¬í•­ (Practical Tips)

* **S3 ë²„í‚· ë° DynamoDB í…Œì´ë¸”:** í…Œë¼ê·¸ëŸ°íŠ¸ì˜ ë°±ì—”ë“œ(Backend) ì„¤ì •ì— ì‚¬ìš©ëœ S3(ìƒíƒœ ì €ì¥ìš©)ì™€ DynamoDB(ë½ ê´€ë¦¬ìš©)ê¹Œì§€ ì§€ì›Œì¡Œë‹¤ë©´, í…Œë¼ê·¸ëŸ°íŠ¸ ì‹¤í–‰ ì‹œ ë‹¤ì‹œ ìƒì„±í•  ê²ƒì¸ì§€ ë¬»ëŠ” í”„ë¡¬í”„íŠ¸ê°€ ëœ¹ë‹ˆë‹¤. ì´ë•Œ `yes`ë¥¼ ì„ íƒí•˜ì—¬ ë°±ì—”ë“œ ì¸í”„ë¼ë¶€í„° ë‹¤ì‹œ êµ¬ì¶•í•´ì•¼ í•©ë‹ˆë‹¤.
* **ë¶ˆë³€ì„± ì¸í”„ë¼(Immutable Infrastructure):** í…Œë¼ê·¸ëŸ°íŠ¸ë¡œ ì¬ë°°í¬í•˜ë©´ ì´ì „ì— ì‚¬ìš©í•˜ë˜ EC2ì˜ ë‚´ë¶€ ë°ì´í„°ëŠ” ë³µêµ¬ë˜ì§€ ì•Šê³  **ê¹¨ë—í•œ ìƒíƒœì˜ ìƒˆ ì„œë²„**ê°€ ìƒì„±ë©ë‹ˆë‹¤. ì• í”Œë¦¬ì¼€ì´ì…˜ ì½”ë“œ ë°°í¬ ìŠ¤í¬ë¦½íŠ¸ë‚˜ ë°ì´í„°ë² ì´ìŠ¤ ë³µêµ¬ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì¶”ê°€ë¡œ ì‹¤í–‰í•´ì•¼ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

## 3. ìì£¼ ë°œìƒí•˜ëŠ” ì—ëŸ¬ ë° í•´ê²° (Troubleshooting)

* **"Error: Resource already exists":** ê°„í˜¹ ì¼ë¶€ ìì›(ì˜ˆ: ë³´ì•ˆ ê·¸ë£¹)ì´ ì´ë¦„ë§Œ ë‚¨ì€ ì±„ ì‚­ì œë˜ì§€ ì•Šì•˜ì„ ë•Œ ë°œìƒí•©ë‹ˆë‹¤. ì´ ê²½ìš° AWS ì½˜ì†”ì—ì„œ í•´ë‹¹ ìì›ì„ ìˆ˜ë™ìœ¼ë¡œ ì§€ìš°ê±°ë‚˜, `terragrunt import` ëª…ë ¹ì–´ë¡œ ê¸°ì¡´ ìì›ì„ ìƒíƒœ íŒŒì¼ì— ê°•ì œ ì—°ê²°í•´ì•¼ í•©ë‹ˆë‹¤.
* **ì˜ì¡´ì„± ê¼¬ì„:** íŠ¹ì • ëª¨ë“ˆì´ ì‚­ì œëœ ìì›ì˜ IDë¥¼ ì°¸ì¡°í•˜ê³  ìˆì„ ë•Œ ë°œìƒí•©ë‹ˆë‹¤. `terragrunt run-all`ì„ ì‚¬ìš©í•˜ë©´ í…Œë¼ê·¸ëŸ°íŠ¸ê°€ ì•Œì•„ì„œ ì˜ì¡´ì„± ê·¸ë˜í”„(Dependency Graph)ë¥¼ ê·¸ë ¤ í•´ê²°í•´ ì£¼ì§€ë§Œ, ì—ëŸ¬ê°€ ë°˜ë³µëœë‹¤ë©´ í•˜ìœ„ ëª¨ë“ˆë¶€í„° ì°¨ë¡€ëŒ€ë¡œ `apply` í•˜ì‹­ì‹œì˜¤.

> **ê³¼ê¸ˆ ê³ ì§€ (Cost Notice):** > í…Œë¼ê·¸ëŸ°íŠ¸ë¡œ ì „ì²´ ì¸í”„ë¼ë¥¼ ì¬ë°°í¬í•˜ë©´ NAT ê²Œì´íŠ¸ì›¨ì´(NAT Gateway), í”„ë¡œë¹„ì €ë‹ëœ IOPS(Provisioned IOPS) ë“± ìœ ë£Œ ìì›ë“¤ì´ ì¦‰ì‹œ ìƒì„±ë©ë‹ˆë‹¤. ì‹¤ìŠµì´ ëë‚œ í›„ì—ëŠ” ë°˜ë“œì‹œ `terragrunt run-all destroy` ëª…ë ¹ì–´ë¡œ ìì›ì„ í•´ì œí•˜ì—¬ ë¶ˆí•„ìš”í•œ ê³¼ê¸ˆì„ ë°©ì§€í•˜ì„¸ìš”.

---

### ğŸ“Œ ì°¸ì¡° ë° ê³µì‹ ê°€ì´ë“œ (References)

* [Terragrunt ê³µì‹ ë¬¸ì„œ: ì›ê²© ìƒíƒœ ê´€ë¦¬(Keep your remote state configuration DRY)](https://terragrunt.gruntwork.io/docs/features/keep-your-remote-state-configuration-dry/)

---

í…Œë¼ê·¸ëŸ°íŠ¸ë¡œ ì‘ì—…í•˜ì…¨ë‹¤ë©´ ì˜¤íˆë ¤ ë‹¤í–‰ì…ë‹ˆë‹¤! ì„¤ê³„ë„(ì½”ë“œ)ê°€ ì™„ë²½í•˜ê²Œ ë‚¨ì•„ìˆìœ¼ë¯€ë¡œ `apply` í•œ ë²ˆìœ¼ë¡œ ì–´ì œ ì‹¤ìŠµ í™˜ê²½ì„ 100% ë³µì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

Next Step: Terragrunt Refresh ì‹¤í–‰, Terragrunt Plan ê²°ê³¼ í™•ì¸, ì „ì²´ ì¸í”„ë¼ ì¬ë°°í¬(Apply)
