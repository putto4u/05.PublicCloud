## AWS-NUKE 실행 후 기본 리소스 복구 및 환경 재설정

`aws-nuke`를 사용하여 리소스를 삭제하면 사용자가 생성한 자원뿐만 아니라, AWS 계정 생성 시 기본적으로 제공되던 **Default VPC**(디폴트 브이피씨, 기본 가상 프라이빗 클라우드)와 관련 네트워크 설정까지 모두 삭제될 수 있습니다. 이를 복구하지 않으면 이후 EC2 인스턴스 생성이나 서비스 배포 시 오류가 발생할 수 있습니다.

---

### 1. 필수 복구 대상 리스트

가장 먼저 복구해야 할 핵심 인프라 요소들입니다.

| 복구 대상 | 용어 (Full Name) | 복구 이유 |
| --- | --- | --- |
| **Default VPC** | **Default Virtual Private Cloud** (기본 가상 사설 클라우드) | 대다수 AWS 서비스가 실행될 기본 네트워크 망입니다. |
| **Subnet** | **Default Subnet** (기본 서브넷) | 각 가용 영역(AZ)에서 자원을 배치할 최소 단위입니다. |
| **Internet Gateway** | **Internet Gateway** (인터넷 게이트웨이, IGW) | VPC 내 자원이 외부 인터넷과 통신하기 위해 필수적입니다. |
| **IAM Role/Policy** | **Identity and Access Management** (식별 및 액세스 관리) | 삭제된 관리자 권한이나 서비스 역할을 재설정해야 합니다. |

---

### 2. 주요 리소스별 복구 방법

#### **(1) Default VPC 및 Subnet 복구**

가장 효율적인 방법은 AWS CLI나 콘솔의 '기본 VPC 생성' 기능을 이용하는 것입니다. 수동으로 만들면 '기본(Default)' 속성이 부여되지 않아 일부 서비스에서 인식을 못 할 수 있습니다.

* **방법:** AWS Console → VPC 대시보드 → **Actions** (작업) → **Create default VPC** (기본 VPC 생성) 클릭.
* **결과:** 모든 가용 영역에 기본 서브넷과 인터넷 게이트웨이가 자동으로 생성되고 연결됩니다.

#### **(2) IAM 사용자 및 권한 복구**

만약 `aws-nuke` 설정에서 IAM을 제외하지 않아 루트 권한 외의 계정이 삭제되었다면 재생성이 필요합니다.

1. **Root User**(루트 사용자)로 로그인합니다.
2. **IAM** 서비스로 이동하여 관리자 그룹과 사용자를 다시 생성합니다.
3. **Access Key**(액세스 키)와 **Secret Access Key**(비밀 액세스 키)를 새로 발급받아 로컬 환경의 `~/.aws/credentials`를 업데이트합니다.

#### **(3) S3 버킷 및 CloudWatch Log Group**

이 리소스들은 '기본값'이라는 개념이 없으므로, 기존에 사용하던 이름 그대로 다시 생성해야 연동된 애플리케이션이나 스크립트가 정상 작동합니다.

---

### 3. 실전 팁: 재발 방지를 위한 nuke 설정 보완

앞으로의 실수 방지를 위해 `aws-nuke`의 설정 파일(`config.yaml`)에 보호 필터를 추가하는 것이 좋습니다.

```yaml
# 예시: 특정 리소스 삭제 방지 설정
accounts:
  "123456789012":
    filters:
      IAMUser:
        - "admin-user" # 관리자 계정 제외
      VPC:
        - property: "isDefault"
          value: "true" # 기본 VPC 삭제 방지

```

---

> **주석 (Footnotes)**
> * **Default VPC (기본 가상 사설 클라우드):** AWS 계정 생성 시 리전마다 하나씩 제공되는 사전 구성된 네트워크 환경입니다.
> * **Internet Gateway (인터넷 게이트웨이):** VPC와 인터넷 간의 통신을 가능하게 하는 수평 확장형 가용성 높은 VPC 구성 요소입니다.
> * **IAM (Identity and Access Management):** AWS 리소스에 대한 액세스를 안전하게 제어할 수 있게 해주는 웹 서비스입니다.
> * **Config.yaml (설정 파일):** `aws-nuke`가 어떤 리소스를 삭제하거나 제외할지 정의하는 구성 파일입니다.
> 
> 

---

**비용 및 유료 전환 안내**

* 기본 VPC, 서브넷, 인터넷 게이트웨이 자체는 **생성 및 유지 비용이 무료**입니다.
* 단, 복구 과정에서 생성하는 **NAT Gateway**(넷 게이트웨이)나 **EIP**(탄력적 IP)는 시간당 비용이 발생하므로, 단순 학습용이라면 필요할 때만 생성하시기 바랍니다.

Next Step: AWS CLI를 이용한 기본 VPC 일괄 복구 스크립트 작성 방법
