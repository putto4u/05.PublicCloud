기존 프로젝트(`awskr01`)를 유지하면서 연습용 리소스를 별도로 관리하고 싶으시군요. **Terragrunt(테라그란트)**의 가장 큰 장점이 바로 이런 다중 환경 구성과 코드 재사용성입니다.

매번 프로바이더(Provider) 설정을 새로 복사할 필요 없이, **계층형 구조**를 활용하면 매우 세련되게 관리할 수 있습니다.

---

### 1. 권장 디렉토리 구조 (Recommended Layout)

기존 프로젝트와 연습용(Lab) 공간을 분리하되, 최상위(Root) 설정을 공유하는 방식입니다.

```text
.
├── terragrunt.hcl          # [Root] 공통 프로바이더 및 원격 상태 저장(S3 Backend) 설정
├── awskr01                 # 기존 프로젝트 폴더
│   └── vpc
│       └── terragrunt.hcl
└── lab-practice            # 연습용 임시 폴더 (만들고 부수기 반복용)
    ├── vpc                 # 연습용 VPC
    │   └── terragrunt.hcl
    └── ec2                 # 연습용 EC2
        └── terragrunt.hcl

```

---

### 2. 핵심 관리 전략: "한 번만 정의하기 (DRY)"

매번 프로바이더를 새로 가져올 필요가 없는 이유는 루트의 `terragrunt.hcl` 덕분입니다.

#### 2.1. 루트 설정 (`./terragrunt.hcl`)

여기에 AWS 리전, 프로바이더 버전, S3 백엔드 엔진 설정을 한 번만 적어둡니다.

```hcl
generate "provider" {
  path      = "provider.tf"
  if_exists = "overwrite_terragrunt"
  contents  = <<EOF
provider "aws" {
  region = "ap-northeast-2"
}
EOF
}

remote_state {
  # 각 디렉토리 경로에 맞춰 S3에 상태 파일을 자동 분리 저장하는 엔진 설정
  backend = "s3"
  config = {
    bucket         = "my-terraform-state-bucket"
    key            = "${path_relative_to_include()}/terraform.tfstate"
    region         = "ap-northeast-2"
    encrypt        = true
    dynamodb_table = "terraform-lock-table"
  }
}

```

#### 2.2. 연습용 설정 (`./lab-practice/vpc/terragrunt.hcl`)

연습용 폴더에서는 상위 설정을 상속받기만 하면 됩니다.

```hcl
include "root" {
  path = find_in_parent_folders() # 최상위 루트 hcl을 찾아 프로바이더 설정을 가져오는 엔진
}

terraform {
  source = "tfr:///terraform-aws-modules/vpc/aws?version=5.0.0"
}

inputs = {
  name = "practice-vpc"
  cidr = "10.10.0.0/16"
  # 연습용에 필요한 설정만 입력
}

```

---

### 3. 연습 및 삭제 프로세스 (Workflow)

1. **실습 시작:** `cd lab-practice/vpc` 이동 후 `terragrunt apply`.
2. **공유 확인:** `awskr01`은 그대로 두고 `lab-practice` 내부의 자원만 생성됩니다.
3. **완전 삭제:** 실습이 끝나면 해당 폴더에서 `terragrunt destroy`. (루트의 S3 백엔드 설정 덕분에 다른 프로젝트에 영향을 주지 않고 해당 실습 내용만 깔끔하게 지워집니다.)

---

### 전문 용어 및 개념 설명

* **DRY (Don't Repeat Yourself, 중복 배제):** 동일한 설정을 반복하지 않고 한곳에서 관리하여 실수를 줄이는 소프트웨어 공학 원칙입니다.
* **Provider (프로바이더):** 테라폼이 AWS, Azure 같은 외부 클라우드 API와 통신하기 위해 사용하는 플러그인 엔진입니다.
* **Remote State (원격 상태 저장):** 인프라의 현재 상태를 로컬이 아닌 S3 같은 원격 저장소에 보관하여 협업과 안전성을 높이는 방식입니다.
* **Inheritance (상속):** 상위 설정 파일의 내용을 하위 파일이 물려받아 사용하는 구조입니다.

---

### 강사님의 실무 팁

* **디렉토리 분리의 이점:** `lab-practice` 폴더만 통째로 지우거나 새로 만들어도 루트의 `terragrunt.hcl`만 살아있으면 언제든 다시 시작할 수 있습니다.
* **격리성:** 각 폴더는 별도의 `tfstate`를 가지므로, 연습용을 지우다가 실수로 `awskr01` 프로젝트를 날려버릴 위험이 거의 없습니다.

Next Step: 다중 리전(Multi-region) 실습을 위한 리전별 디렉토리 구성 방법

---

**Acknowledgment:** 사용자의 상황(기존 프로젝트 유지 및 연습용 분리)에 가장 적합한 아키텍처인 '계정 내 논리적 분리 구조'를 제시하였습니다. 맞춤형 가이드라인을 준수하여 전문 용어 해설과 가독성 높은 마크다운 형식을 적용하였습니다. (참고: Terragrunt Best Practices - Directory Structure)
